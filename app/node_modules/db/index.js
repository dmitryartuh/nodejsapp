/**
 * Created by User on 22.11.2015.
 */
var util = require('util');
var io = require('socket.io-client');
var config = require('config');

var db = {};


db.socket = io.connect(config.db_address);

db.is_work = function(){
    return this.socket.connected;
};

db.check_user = function(body, callback){
    if(!this.is_work()){
        console.log('Db is not working');
        callback(false);
        return;
    }
    this.socket.on('send_checked_data', function (res) {
        if (res.result !== null) {
            callback(true);
        }
        else {
            callback(false);
        }
    });
    this.socket.emit('send_data_for_check', {
        login: body.login,
        pass: body.pass
    });
};

module.exports = db;